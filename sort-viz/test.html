<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script src="https://d3js.org/d3.v5.min.js"></script>
    </head>
    <body>
        <div class="someclass">
            <h2>Create A Bar Chart With D3 JavaScript</h2>
            <div id="bar-chart">
                <svg></svg>
            </div>
        </div>
    </body>

    <script>
        // d3.select("body").style("background-color", "orange");
        // // Update…
        // var p = d3
        //     .select("body")
        //     .selectAll("p")
        //     .data([4, 8, 15, 16, 23, 42])
        //     .text(function(d) {
        //         return d;
        //     });
        // // Enter…
        // p.enter()
        //     .append("p")
        //     .text(function(d) {
        //         return d;
        //     });

        // // Exit…
        // p.exit().remove();

        //  the data that powers the bar chart, a simple array of numeric values
        let chartdata = [40, 60, 80, 100, 70, 120, 100, 60, 70, 150, 120, 140];

        //  the size of the overall svg element
        let height = 720,
            width = 200,
            //  the width of each bar and the offset between each bar
            barWidth = 40,
            barOffset = 10;

        let svg = d3.select("#bar-chart").select("svg");
        svg.style("width", width)
            .style("height", height)
            .style("background", "#dff0d8");

        setTimeout(() => {
            chartdata[1] = 100;
            console.log(chartdata);
            refresh(chartdata);
        }, 2000);

        var refresh = (data) => {
            // chart.exit().remove();
            console.log(data);
            svg.selectAll("rect")
                .data(data)
                .enter()
                .append("rect")
                .style("fill", "#3c763d") // replace this fill color with a function
                .style("stroke", "#d6e9c6")
                .style("stroke-width", "5")
                .style("height", barWidth)
                .style("width", function(data) {
                    return data;
                })
                .style("y", function(data, i) {
                    return i * (barWidth + barOffset);
                })
                .style("x", 0);

            svg.exit().remove();
        };

        refresh(chartdata);
    </script>
</html>
